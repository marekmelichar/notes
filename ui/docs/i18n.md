# Internationalization (i18n)

This project uses [i18next](https://www.i18next.com/) for internationalization with React bindings.

## Overview

Features:
- Multiple language support
- Lazy loading of translations
- Browser language detection
- Namespace support
- Interpolation and pluralization

## File Structure

```
public/
└── locales/
    ├── en/
    │   └── translation.json
    └── cs/
        └── translation.json
src/
└── i18n/
    └── index.ts           # i18next configuration
```

## Configuration

`src/i18n/index.ts`:

```typescript
import i18n from 'i18next';
import { initReactI18next } from 'react-i18next';
import HttpBackend from 'i18next-http-backend';
import LanguageDetector from 'i18next-browser-languagedetector';

i18n
  .use(HttpBackend)           // Load translations via HTTP
  .use(LanguageDetector)      // Detect user language
  .use(initReactI18next)      // React bindings
  .init({
    fallbackLng: 'en',
    debug: false,
    interpolation: {
      escapeValue: false,     // React already escapes
    },
    backend: {
      loadPath: '/locales/{{lng}}/{{ns}}.json',
    },
  });

export default i18n;
```

## Translation Files

### English (`public/locales/en/translation.json`):

```json
{
  "Common": {
    "Logo": "Logo",
    "Nav": {
      "Home": "Home",
      "Settings": "Settings"
    },
    "Loading": "Loading...",
    "Save": "Save",
    "Cancel": "Cancel",
    "Delete": "Delete",
    "Welcome": "Welcome"
  },
  "HomePage": {
    "Description": "This is your starter template."
  },
  "ErrorPage": {
    "Title": "Something went wrong",
    "Message": "An unexpected error occurred.",
    "ReloadPage": "Reload Page"
  }
}
```

### Czech (`public/locales/cs/translation.json`):

```json
{
  "Common": {
    "Logo": "Logo",
    "Nav": {
      "Home": "Domů",
      "Settings": "Nastavení"
    },
    "Loading": "Načítám...",
    "Save": "Uložit",
    "Cancel": "Zrušit",
    "Delete": "Smazat",
    "Welcome": "Vítejte"
  },
  "HomePage": {
    "Description": "Toto je váš startovací šablona."
  },
  "ErrorPage": {
    "Title": "Něco se pokazilo",
    "Message": "Došlo k neočekávané chybě.",
    "ReloadPage": "Obnovit stránku"
  }
}
```

## Usage

### Using the `useTranslation` Hook

```typescript
import { useTranslation } from 'react-i18next';

const MyComponent = () => {
  const { t } = useTranslation();

  return (
    <div>
      <h1>{t('Common.Welcome')}</h1>
      <p>{t('HomePage.Description')}</p>
      <button>{t('Common.Save')}</button>
    </div>
  );
};
```

### With Interpolation

Translation file:
```json
{
  "greeting": "Hello, {{name}}!"
}
```

Component:
```typescript
const { t } = useTranslation();
<p>{t('greeting', { name: 'John' })}</p>
// Output: "Hello, John!"
```

### Pluralization

Translation file:
```json
{
  "items": "{{count}} item",
  "items_plural": "{{count}} items"
}
```

Component:
```typescript
<p>{t('items', { count: 1 })}</p>  // "1 item"
<p>{t('items', { count: 5 })}</p>  // "5 items"
```

### Outside React Components

```typescript
import i18n from '@/i18n';

// Get translation
const message = i18n.t('Common.Loading');

// Change language
i18n.changeLanguage('cs');

// Get current language
const lang = i18n.language;
```

## Language Switching

### LanguageSwitch Component

The project includes a language switcher component:

```typescript
// src/components/LanguageSwitch/index.tsx
import i18n from '@/i18n';

const languages = [
  { code: 'en', label: 'English' },
  { code: 'cs', label: 'Čeština' },
];

export const LanguageSwitch = () => {
  const handleSelect = (lang: string) => {
    i18n.changeLanguage(lang);
  };

  return (
    <Select onChange={(e) => handleSelect(e.target.value)}>
      {languages.map(({ code, label }) => (
        <MenuItem key={code} value={code}>
          {label}
        </MenuItem>
      ))}
    </Select>
  );
};
```

### Language Persistence

i18next-browser-languagedetector automatically:
- Detects browser language
- Saves preference to localStorage
- Uses query parameter (`?lng=en`)

## Adding a New Language

1. **Create translation file:**

```bash
mkdir -p public/locales/de
touch public/locales/de/translation.json
```

2. **Add translations:**

```json
{
  "Common": {
    "Welcome": "Willkommen",
    "Save": "Speichern"
  }
}
```

3. **Update LanguageSwitch:**

```typescript
const languages = [
  { code: 'en', label: 'English' },
  { code: 'cs', label: 'Čeština' },
  { code: 'de', label: 'Deutsch' },  // Add new language
];
```

## Namespaces

For large apps, split translations into namespaces:

```
public/locales/en/
├── translation.json    # Default namespace
├── common.json         # Shared translations
└── errors.json         # Error messages
```

Usage:
```typescript
const { t } = useTranslation('errors');
<p>{t('notFound')}</p>
```

Load multiple namespaces:
```typescript
const { t } = useTranslation(['translation', 'errors']);
```

## Best Practices

### 1. Use Nested Keys

```json
// Good
{
  "User": {
    "Profile": {
      "Title": "Profile"
    }
  }
}

// Avoid flat structure for large apps
{
  "userProfileTitle": "Profile"
}
```

### 2. Keep Keys Consistent

Use the same key structure across all languages.

### 3. Don't Hardcode Text

```typescript
// Good
<Button>{t('Common.Save')}</Button>

// Bad
<Button>Save</Button>
```

### 4. Handle Missing Translations

```typescript
i18n.init({
  saveMissing: true,
  missingKeyHandler: (lng, ns, key) => {
    console.warn(`Missing translation: ${lng}/${ns}/${key}`);
  },
});
```

### 5. Use TypeScript for Type Safety

Create a type definition for your translations:

```typescript
// src/types/i18n.d.ts
import 'i18next';
import translation from '../../public/locales/en/translation.json';

declare module 'i18next' {
  interface CustomTypeOptions {
    defaultNS: 'translation';
    resources: {
      translation: typeof translation;
    };
  }
}
```

## Date and Number Formatting

Use `dayjs` for dates (already included):

```typescript
import dayjs from 'dayjs';
import 'dayjs/locale/cs';

// Set locale based on i18n language
dayjs.locale(i18n.language);

const formatted = dayjs().format('LL'); // Localized date
```

For numbers:
```typescript
const formatted = new Intl.NumberFormat(i18n.language).format(1234.56);
```

## Debugging

Enable debug mode:
```typescript
i18n.init({
  debug: true,
});
```

This logs:
- Missing keys
- Loading events
- Language changes
